{% extends "layout.html" %}

{% block title %}{% endblock %}

{% block content %}
{#------------------- filters -------------------#}
<nav>
  <h2 class="inline">{{disc.title}}</h2>
  <form class="inline" method="post" action="/lecture/search/{{disc.id}}">
    <fieldset role="group" style="margin-left: 30px;">
    <input name="sample" style="width: 200px; "/>
    <button class="outline" style="font-size: large;">üîç</button>
    </fieldset>
  </form>
</nav>

<a href="/lecture/new/{{disc.id}}" style="margin-right: 60px;">New lecture</a>
<a href="/lecture/publish/{{disc.id}}" style="margin-right: 60px;">Publish</a>

{#------------------- lectures ------------------#}

{% if disc.lectures and disc.lectures|length %}
<table>
  <tbody>
    {% for lecture in disc.lectures %}
    {% set checked = "checked" if lecture.is_public else "" %}
    
    <tr>
      <td>
        <input type="checkbox" {{checked}} onchange="f(event, {{lecture.id}})" >
        <a href="/lecture/edit/{{lecture.id}}"> {{ lecture.title }} </a>
        <span style="margin-left: 20px; font-size: small;">{{lecture.volume // 100 / 10}}</span>
      </td>
      <td>
        <a href="/lecture/play/{{lecture.id}}">play</a> | 
        <a href="/lecture/del/{{lecture.id}}">del</a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
  <div>
    No lectures.
  </div>
{% endif %}

{% endblock %}

{% block script %}
<script>
  async function f(e, lect_id) {
    let url = `/lecture/public/${lect_id}`
    await fetch(url, { method: "POST"});
  }
</script>
{% endblock %}
